var o=[],e=[],n=[],t=null,a=null,l=null,i=null,r=null,s=null;window.initMap=function(){navigator.geolocation&&navigator.geolocation.getCurrentPosition((g=>{const c={lat:g.coords.latitude,lng:g.coords.longitude};t=g.coords.latitude,a=g.coords.longitude;const p=new google.maps.Map(document.getElementById("map"),{zoom:10,center:c}),m=new google.maps.Marker({position:c,map:p,title:"Your Location",animation:google.maps.Animation.DROP});var d="username=xXoDw780&lat="+c.lat+"&lng="+c.lng,u=new XMLHttpRequest;u.open("POST","https://kmehta-notuber-3.herokuapp.com/rides",!0),u.setRequestHeader("Content-type","application/x-www-form-urlencoded"),u.send(d),u.onload=function(){const g=JSON.parse(this.responseText);var c=0;g.forEach((function(t){var a=[];o[c]=t.username,e[c]=t.lat,n[c]=t.lng,a[c]=new google.maps.Marker({position:{lat:t.lat,lng:t.lng},map:p,title:"Vehicle ID:"+o[c],animation:google.maps.Animation.DROP,icon:"carForMaps.png"}),a[c].addListener("click",(function(){v.open(p,a[c])})),c+=1}));for(let g=0;g<c;g++){var d=new google.maps.LatLng(e[g],n[g]),u=new google.maps.LatLng(t,a),w=621371e-9*google.maps.geometry.spherical.computeDistanceBetween(d,u);0==g&&(l=w,i=o[0],r=e[0],s=n[0]),w<l&&(l=w,i=o[g],r=e[g],s=n[g])}const h=[{lat:t,lng:a},{lat:r,lng:s}];new google.maps.Polyline({path:h,geodesic:!0,strokeColor:"#FF0000",strokeOpacity:1,strokeWeight:3}).setMap(p);var f='<div id="info"><h1>My Nearest Ride</h1><p> The nearest ride from your location is RIDE ID: '+i+" which is "+Math.trunc(l)+" miles away at lat: "+r+" lng: "+s+"</p></div>",v=new google.maps.InfoWindow({content:f});m.addListener("click",(function(){v.open(p,m)}))}}))};